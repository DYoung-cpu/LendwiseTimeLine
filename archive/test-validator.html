<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Change Validator Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 40px;
        }

        .test-area {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        button:hover {
            background: #5a67d8;
        }

        button.danger {
            background: #f56565;
        }

        button.danger:hover {
            background: #e53e3e;
        }

        button.success {
            background: #48bb78;
        }

        button.success:hover {
            background: #38a169;
        }

        .status {
            padding: 15px;
            background: #f7fafc;
            border-left: 4px solid #667eea;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .console-output {
            background: #1a202c;
            color: #63b3ed;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        /* Test elements to move */
        .test-element {
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .test-filter {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: #667eea;
            padding: 8px 20px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 2px solid #667eea;
        }

        #demo-container {
            position: relative;
            padding: 40px 20px 20px;
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid #667eea;
            border-radius: 10px;
            margin-top: 30px;
        }

        .error {
            color: #e53e3e;
        }

        .success {
            color: #38a169;
        }

        .warning {
            color: #ed8936;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è CSS Change Validator Test Suite</h1>

        <div class="test-area">
            <h2>Validator Controls</h2>

            <div class="status">
                <strong>Status:</strong> <span id="status">Ready</span>
            </div>

            <div class="controls">
                <button onclick="testCapture()" class="success">1. Capture State</button>
                <button onclick="testGoodChange()">2. Make Good Change</button>
                <button onclick="testBadPosition()" class="danger">3. Bad Position Change</button>
                <button onclick="testInvisible()" class="danger">4. Make Invisible</button>
                <button onclick="testValidate()">5. Validate</button>
                <button onclick="testVisualDiff()">6. Visual Diff</button>
                <button onclick="testAutoRollback()" class="danger">7. Test Auto-Rollback</button>
                <button onclick="resetElements()">Reset All</button>
            </div>

            <div id="demo-container">
                <div class="test-filter">Filter Badge</div>
                <div class="test-element" id="test-element">
                    This is a test element for the CSS validator
                </div>
            </div>

            <div class="console-output" id="console">
                Console output will appear here...
            </div>
        </div>

        <div class="test-area">
            <h2>Test Scenarios</h2>

            <h3>‚úÖ Safe Changes (Should Pass)</h3>
            <ul>
                <li>Small position adjustments (&lt;50px)</li>
                <li>Color and style changes</li>
                <li>Padding and margin tweaks</li>
            </ul>

            <h3>‚ùå Dangerous Changes (Should Trigger Warnings)</h3>
            <ul>
                <li>Large position changes (&gt;100px)</li>
                <li>Making elements invisible</li>
                <li>Breaking centering alignment</li>
                <li>Elements moving outside viewport</li>
            </ul>

            <h3>üìù Workflow Tests</h3>
            <ol>
                <li>Click "Capture State" to baseline</li>
                <li>Try different changes</li>
                <li>Click "Validate" to check</li>
                <li>Use "Visual Diff" to see changes</li>
                <li>Test "Auto-Rollback" for protection</li>
            </ol>
        </div>
    </div>

    <!-- Load the inspector -->
    <script src="inspector.js"></script>

    <script>
        // Console output helper
        function logToConsole(message, type = 'info') {
            const consoleEl = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'error' : type === 'success' ? 'success' : '';

            consoleEl.innerHTML += `<div class="${colorClass}">[${timestamp}] ${message}</div>`;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = type;
        }

        // Test functions
        function testCapture() {
            logToConsole('üì∏ Capturing current state...', 'info');
            const result = window.captureCSS(['#demo-container', '.test-filter', '#test-element']);

            if (result) {
                logToConsole('‚úÖ State captured successfully', 'success');
                updateStatus('State captured - ready for testing', 'success');
            }
        }

        function testGoodChange() {
            logToConsole('Making small position adjustment...', 'info');
            const element = document.getElementById('test-element');
            element.style.marginLeft = '10px';
            element.style.padding = '25px';

            logToConsole('Changed: margin-left +10px, padding +5px', 'info');
            updateStatus('Good change applied', 'success');
        }

        function testBadPosition() {
            logToConsole('‚ö†Ô∏è Making large position change...', 'warning');
            const filter = document.querySelector('.test-filter');
            filter.style.top = '200px';
            filter.style.left = '10px';

            logToConsole('Moved filter far from original position', 'error');
            updateStatus('Bad position applied - should fail validation', 'error');
        }

        function testInvisible() {
            logToConsole('‚ö†Ô∏è Making element invisible...', 'warning');
            const element = document.getElementById('test-element');
            element.style.display = 'none';

            logToConsole('Element hidden with display:none', 'error');
            updateStatus('Element hidden - should trigger warnings', 'error');
        }

        function testValidate() {
            logToConsole('üîç Running validation...', 'info');

            const result = window.validateCSS(
                ['#demo-container', '.test-filter', '#test-element'],
                {
                    '.test-filter': { centered: true },
                    '#demo-container': { top: 200 }
                }
            );

            if (result.failed.length === 0) {
                logToConsole('‚úÖ All validations passed!', 'success');
                updateStatus('Validation passed', 'success');
            } else {
                logToConsole(`‚ùå ${result.failed.length} validation failures`, 'error');
                result.failed.forEach(f => logToConsole(`  - ${f}`, 'error'));
                updateStatus('Validation failed', 'error');
            }

            if (result.warnings.length > 0) {
                result.warnings.forEach(w => logToConsole(`‚ö†Ô∏è Warning: ${w}`, 'warning'));
            }
        }

        function testVisualDiff() {
            logToConsole('üì∏ Generating visual diff...', 'info');

            const result = window.visualDiff(['#demo-container', '.test-filter', '#test-element']);

            result.forEach(item => {
                if (item.changes && item.changes.details.length > 0) {
                    logToConsole(`üîÑ ${item.selector} changed:`, 'info');
                    item.changes.details.forEach(detail => {
                        logToConsole(`  - ${detail}`, 'warning');
                    });
                } else if (item.status === 'no baseline') {
                    logToConsole(`‚ö†Ô∏è ${item.selector}: No baseline (capture first)`, 'warning');
                } else {
                    logToConsole(`‚úÖ ${item.selector}: No changes`, 'success');
                }
            });

            updateStatus('Visual diff complete', 'info');
        }

        function testAutoRollback() {
            logToConsole('üõ°Ô∏è Enabling auto-rollback protection...', 'info');

            window.enableAutoRollback();

            logToConsole('Monitoring for dangerous changes...', 'info');
            logToConsole('Try making a bad change - rollback will trigger!', 'warning');

            // Monitor for 10 seconds
            window.monitorCSS(['#demo-container', '.test-filter', '#test-element']);

            updateStatus('Auto-rollback active (10 seconds)', 'warning');

            // Make a bad change after 2 seconds
            setTimeout(() => {
                logToConsole('üî¥ Making dangerous change in 2 seconds...', 'error');
                const filter = document.querySelector('.test-filter');
                filter.style.top = '500px';
            }, 2000);
        }

        function resetElements() {
            logToConsole('üîÑ Resetting all elements...', 'info');

            // Reset test element
            const element = document.getElementById('test-element');
            element.style = '';

            // Reset filter
            const filter = document.querySelector('.test-filter');
            filter.style = '';

            // Clear console
            document.getElementById('console').innerHTML = 'Reset complete. Ready for new tests...';

            updateStatus('Reset complete', 'success');
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            logToConsole('üöÄ CSS Change Validator Test Suite Ready!', 'success');
            logToConsole('Click buttons to test different scenarios', 'info');
        });
    </script>
</body>
</html>